Description: src/wav.c: Fix heap read overflow in wav_write_header
 The loop count is supposed to be a signed 16 bit number but the type of
 loop_count is int. Users might trick the libsndfile to get loop_count
 above legal 16 bit values. Make sure invalid bits are cut off before
 accessing the loop count.
Author: Erik de Castro Lopo <erikd@mega-nerd.com>
Origin: upstream, https://github.com/erikd/libsndfile/commit/42132c543358cee9f7c3e9e9b15bb6c1063a608e
Bug: https://github.com/erikd/libsndfile/issues/435
--- a/src/wav.c
+++ b/src/wav.c
@@ -1093,6 +1093,8 @@
 		psf_binheader_writef (psf, "44", 0, 0) ; /* SMTPE format */
 		psf_binheader_writef (psf, "44", psf->instrument->loop_count, 0) ;
 
+		/* Loop count is signed 16 bit number so we limit it range to something sensible. */
+		psf->instrument->loop_count &= 0x7fff ;
 		for (tmp = 0 ; tmp < psf->instrument->loop_count ; tmp++)
 		{	int type ;
 
