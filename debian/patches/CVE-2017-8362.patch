Description: src/flac.c: Fix a buffer read overflow
 A file (generated by a fuzzer) which increased the number of channels
 from one frame to the next could cause a read beyond the end of the
 buffer provided by libFLAC. Only option is to abort the read.
Author: Erik de Castro Lopo <erikd@mega-nerd.com>
Origin: https://github.com/erikd/libsndfile/commit/ef1dbb2df1c0e741486646de40bd638a9c4cd808
Bug: https://github.com/erikd/libsndfile/issues/231
--- a/src/flac.c	2018-12-15 13:25:24.941155206 +0100
+++ b/src/flac.c	2018-12-15 13:37:22.661623609 +0100
@@ -164,6 +164,14 @@
 	const FLAC__int32* const *buffer = pflac->wbuffer ;
 	unsigned i = 0, j, offset ;
 
+	if (psf->sf.channels != (int) frame->header.channels)
+	{	psf_log_printf (psf, "Error: FLAC frame changed from %d to %d channels\n"
+				     "Nothing to do but to error out.\n" ,
+				     psf->sf.channels, frame->header.channels) ;
+		psf->error = SFE_FLAC_CHANNEL_COUNT_CHANGED ;
+		return 0 ;
+	} ;
+
 	/*
 	**	frame->header.blocksize is variable and we're using a constant blocksize
 	**	of FLAC__MAX_BLOCK_SIZE.
